"use strict";angular.module("ng.httpLoader",["ng.httpLoader.httpMethodInterceptor"]).directive("ngHttpLoader",["$rootScope","$parse","$timeout",function(e,t,n){return{scope:{methods:"@",template:"@",title:"@",ttl:"@",beforeloadershow:"@",afterloadershow:"@",beforeloaderhide:"@",afterloaderhide:"@"},template:'<div class="http-loader__wrapper" '+'ng-include="template" '+'ng-show="showLoader"></div>',link:function(r){var i=t(r.beforeloadershow)()||r.beforeloadershow;var s=t(r.afterloadershow)()||r.afterloadershow;var o=t(r.beforeloaderhide)()||r.beforeloaderhide;var u=t(r.afterloaderhide)()||r.afterloaderhide;var a=t(r.methods)()||r.methods;a=angular.isUndefined(a)?[]:a;a=angular.isArray(a)?a:[a];angular.forEach(a,function(e,t){a[t]=e.toUpperCase()});var f=t(r.ttl)()||r.ttl;f=angular.isUndefined(f)?0:f;f=Number(f)*1e3;f=angular.isNumber(f)?f:0;if(!Array.prototype.indexOf){a.indexOf=function(e){for(var t=this.length;t--;){if(this[t]===e){return t}}return-1}}r.showLoader=false;var l=r.showLoader;var c;var h="";var p="";var d=function(t,d){switch(t.name){case"loaderShow":h=i;p=s;break;case"loaderHide":h=o;p=u;break}if(h!==""){e.$broadcast(h)}if(a.indexOf(d.toUpperCase())!==-1){l=t.name==="loaderShow"}else if(a.length===0){l=t.name==="loaderShow"}if(f<=0||!c&&!l){r.showLoader=l;if(p!==""){e.$broadcast(p)}return}else if(c){return}r.showLoader=l;c=n(function(){if(!l){r.showLoader=l}if(p!==""){e.$broadcast(p)}c=undefined},f)};e.$on("loaderShow",d);e.$on("loaderHide",d)}}}]);angular.module("ng.httpLoader.httpMethodInterceptor",[]).provider("httpMethodInterceptor",function(){var e=[];var t=[];this.requestConfig=function(t){e.push(t)};this.$get=["$q","$rootScope",function(t,n){var r=0;var i=function(t){for(var n=e.length;n--;){if(t.indexOf(e[n]["url"])!==-1){return true}}return false};var s=function(t){if(i(t.url)){for(var n=e.length;n--;){if(t.url.indexOf(e[n]["url"])!==-1&&t.headers[e[n]["headerName"]]===e[n]["requestType"]){return true}}}return false};var o=function(e){if(s(e)&&--r===0){n.$emit("loaderHide",e.method)}};return{request:function(e){if(s(e)){r++;n.$emit("loaderShow",e.method)}return e||t.when(e)},response:function(e){o(e.config);return e||t.when(e)},responseError:function(e){o(e.config);return t.reject(e)}}}]}).config(["$httpProvider",function(e){e.interceptors.push("httpMethodInterceptor")}])
